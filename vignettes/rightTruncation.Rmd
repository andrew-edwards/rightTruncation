---
title: "rightTruncation"
author: "Andrew Edwards"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{rightTruncation}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.width = 5.7,
  fig.height = 7
)
```

```{r setup}
library(rightTruncation)
```

# Likelihood fitting of Weibull delay distribution to right-truncated data

See the readme at <https://github.com/andrew-edwards/rightTruncation> for
details, including link to the manuscript that contains the mathematical
background. In particular, Appendix A.2 gives full details and derivations.

The data on individual cases (Figure~\ref{fig:symptoms}) give counts $h_{nr}$ of
the number of individuals whose case was reported (test was positive) at the end
of day $r$ and whose symptoms are estimated to have started on day $n$. If day
$N$ is the final day of these data, then the full data set is $\{ h_{nr} \}_{n =
0, 1, 2, ..., N; n \leq r \leq N}$, where, by definition, $h_{nr} = 0$ for $r <
n$ because a case cannot be reported before the start of symptoms for these
data. The counts are right-truncated on day $N$, since there are individuals
whose symptoms started on day $n$ who will be reported in the future (after
$N$), but we do not yet know when. The cases are considered to be reported at
the end of day $r$ because there are values of $h_{nn} > 0$.

An example simulated data set is
```{r simulated}
h_nr_simulated <- h_nr_simulate(N = 10)
h_nr_simulated
```
