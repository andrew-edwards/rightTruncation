<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="Andrew Edwards" />


<title>rightTruncation</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#header {
text-align: center;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; }  code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">rightTruncation</h1>
<h4 class="author">Andrew Edwards</h4>



<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="kw">library</span>(rightTruncation)</a></code></pre></div>
<div id="likelihood-fitting-of-weibull-delay-distribution-to-right-truncated-data" class="section level1">
<h1>Likelihood fitting of Weibull delay distribution to right-truncated data</h1>
<p>This vignette should be self-contained (without going into all the calculations) such that the functions can be applied to other data.See the readme at <a href="https://github.com/andrew-edwards/rightTruncation" class="uri">https://github.com/andrew-edwards/rightTruncation</a> for details, including the link to the manuscript that contains the mathematical background. In particular, Appendix A.2 gives full details and derivations.</p>
<p>The data in British Columbia, Canada, are counts <span class="math inline">\(h_{nr}\)</span> of the number of individuals whose case was reported (test was positive) at the end of day <span class="math inline">\(r\)</span> and whose symptoms are estimated to have started on day <span class="math inline">\(n\)</span>.</p>
<div id="simple-matrix-example" class="section level2">
<h2>Simple matrix example</h2>
<p>An example simulated data set gives the values of <span class="math inline">\(h_{nr}\)</span> as a matrix:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1">h_nr_simulated &lt;-<span class="st"> </span><span class="kw">h_nr_simulate</span>(<span class="dt">N =</span> <span class="dv">10</span>)</a>
<a class="sourceLine" id="cb2-2" data-line-number="2">h_nr_simulated</a>
<a class="sourceLine" id="cb2-3" data-line-number="3">      [,<span class="dv">1</span>] [,<span class="dv">2</span>] [,<span class="dv">3</span>] [,<span class="dv">4</span>] [,<span class="dv">5</span>] [,<span class="dv">6</span>] [,<span class="dv">7</span>] [,<span class="dv">8</span>] [,<span class="dv">9</span>] [,<span class="dv">10</span>] [,<span class="dv">11</span>]</a>
<a class="sourceLine" id="cb2-4" data-line-number="4"> [<span class="dv">1</span>,]    <span class="dv">1</span>    <span class="dv">5</span>   <span class="dv">10</span>    <span class="dv">6</span>    <span class="dv">8</span>   <span class="dv">12</span>    <span class="dv">8</span>    <span class="dv">9</span>    <span class="dv">8</span>     <span class="dv">5</span>     <span class="dv">6</span></a>
<a class="sourceLine" id="cb2-5" data-line-number="5"> [<span class="dv">2</span>,]    <span class="dv">0</span>    <span class="dv">0</span>    <span class="dv">2</span>    <span class="dv">8</span>    <span class="dv">6</span>   <span class="dv">14</span>    <span class="dv">9</span>   <span class="dv">12</span>    <span class="dv">7</span>     <span class="dv">9</span>     <span class="dv">6</span></a>
<a class="sourceLine" id="cb2-6" data-line-number="6"> [<span class="dv">3</span>,]    <span class="dv">0</span>    <span class="dv">0</span>    <span class="dv">1</span>    <span class="dv">3</span>    <span class="dv">3</span>    <span class="dv">9</span>    <span class="dv">5</span>    <span class="dv">3</span>    <span class="dv">8</span>    <span class="dv">13</span>     <span class="dv">8</span></a>
<a class="sourceLine" id="cb2-7" data-line-number="7"> [<span class="dv">4</span>,]    <span class="dv">0</span>    <span class="dv">0</span>    <span class="dv">0</span>    <span class="dv">1</span>    <span class="dv">6</span>    <span class="dv">9</span>    <span class="dv">4</span>    <span class="dv">7</span>    <span class="dv">9</span>     <span class="dv">8</span>    <span class="dv">10</span></a>
<a class="sourceLine" id="cb2-8" data-line-number="8"> [<span class="dv">5</span>,]    <span class="dv">0</span>    <span class="dv">0</span>    <span class="dv">0</span>    <span class="dv">0</span>    <span class="dv">0</span>    <span class="dv">3</span>    <span class="dv">6</span>    <span class="dv">9</span>    <span class="dv">5</span>     <span class="dv">7</span>     <span class="dv">5</span></a>
<a class="sourceLine" id="cb2-9" data-line-number="9"> [<span class="dv">6</span>,]    <span class="dv">0</span>    <span class="dv">0</span>    <span class="dv">0</span>    <span class="dv">0</span>    <span class="dv">0</span>    <span class="dv">3</span>    <span class="dv">2</span>    <span class="dv">6</span>    <span class="dv">5</span>    <span class="dv">10</span>     <span class="dv">9</span></a>
<a class="sourceLine" id="cb2-10" data-line-number="10"> [<span class="dv">7</span>,]    <span class="dv">0</span>    <span class="dv">0</span>    <span class="dv">0</span>    <span class="dv">0</span>    <span class="dv">0</span>    <span class="dv">0</span>    <span class="dv">0</span>    <span class="dv">3</span>    <span class="dv">5</span>    <span class="dv">10</span>     <span class="dv">6</span></a>
<a class="sourceLine" id="cb2-11" data-line-number="11"> [<span class="dv">8</span>,]    <span class="dv">0</span>    <span class="dv">0</span>    <span class="dv">0</span>    <span class="dv">0</span>    <span class="dv">0</span>    <span class="dv">0</span>    <span class="dv">0</span>    <span class="dv">1</span>    <span class="dv">4</span>     <span class="dv">8</span>     <span class="dv">6</span></a>
<a class="sourceLine" id="cb2-12" data-line-number="12"> [<span class="dv">9</span>,]    <span class="dv">0</span>    <span class="dv">0</span>    <span class="dv">0</span>    <span class="dv">0</span>    <span class="dv">0</span>    <span class="dv">0</span>    <span class="dv">0</span>    <span class="dv">0</span>    <span class="dv">0</span>     <span class="dv">2</span>    <span class="dv">11</span></a>
<a class="sourceLine" id="cb2-13" data-line-number="13">[<span class="dv">10</span>,]    <span class="dv">0</span>    <span class="dv">0</span>    <span class="dv">0</span>    <span class="dv">0</span>    <span class="dv">0</span>    <span class="dv">0</span>    <span class="dv">0</span>    <span class="dv">0</span>    <span class="dv">0</span>     <span class="dv">1</span>     <span class="dv">2</span></a>
<a class="sourceLine" id="cb2-14" data-line-number="14">[<span class="dv">11</span>,]    <span class="dv">0</span>    <span class="dv">0</span>    <span class="dv">0</span>    <span class="dv">0</span>    <span class="dv">0</span>    <span class="dv">0</span>    <span class="dv">0</span>    <span class="dv">0</span>    <span class="dv">0</span>     <span class="dv">0</span>     <span class="dv">1</span></a></code></pre></div>
<p>The matrix is upper diagonal (all the entries below the diagonal are zero) because <span class="math inline">\(h_{nr} = 0\)</span> for <span class="math inline">\(r &lt; n\)</span>, since a case cannot be reported before the start of symptoms. Day <span class="math inline">\(N\)</span> is the final day of the data (<span class="math inline">\(N = 10\)</span> in the example), such that the non-zero values are <span class="math inline">\(\{ h_{nr} \}_{n = 0, 1, 2, ..., N; n \leq r \leq N}\)</span>.</p>
<p>The counts are right-truncated on day <span class="math inline">\(N\)</span> – there are individuals whose symptoms started on day <span class="math inline">\(n\)</span> who will be reported in the future (after <span class="math inline">\(N\)</span>), but we do not yet know when. For example, for people whose symptoms started on day <span class="math inline">\(n=8\)</span>, we only know about those whose cases were reported on days 8, 9 and 10. Anyone who will have a delay between symptom onset and reporting that is longer than 2 days is not in our data set and, crucially, we don’t even know about them yet. The cases are considered to be reported at the end of day <span class="math inline">\(r\)</span> because there are values of <span class="math inline">\(h_{nn} &gt; 0\)</span>. The example matrix is size 11x11 since days start at 0 and end at <span class="math inline">\(N=10\)</span>.</p>
<p>The maximum likelihood is calculated by minimising the negative log-likelihood function:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1">MLE_res =<span class="st"> </span><span class="kw">nlm</span>(<span class="dt">f =</span> negLL_Weibull_counts_matrix,</a>
<a class="sourceLine" id="cb3-2" data-line-number="2">              <span class="dt">p =</span> <span class="kw">c</span>(<span class="dv">3</span>, <span class="dv">15</span>),</a>
<a class="sourceLine" id="cb3-3" data-line-number="3">              <span class="dt">h_nr =</span> h_nr_simulated)</a></code></pre></div>
<p>(Note that such code usually gives warnings about NaNs being produced during the optimisation; these have been suppressed in this vignette). The main results of interest are the MLEs for <span class="math inline">\(k\)</span> and <span class="math inline">\(\lambda\)</span>, and also the resulting mean and median:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1">k_MLE &lt;-<span class="st"> </span>MLE_res<span class="op">$</span>estimate[<span class="dv">1</span>]</a>
<a class="sourceLine" id="cb4-2" data-line-number="2">lambda_MLE &lt;-<span class="st"> </span>MLE_res<span class="op">$</span>estimate[<span class="dv">2</span>]</a>
<a class="sourceLine" id="cb4-3" data-line-number="3">k_MLE      <span class="co"># shape</span></a>
<a class="sourceLine" id="cb4-4" data-line-number="4">[<span class="dv">1</span>] <span class="fl">2.105375</span></a>
<a class="sourceLine" id="cb4-5" data-line-number="5">lambda_MLE <span class="co"># scale</span></a>
<a class="sourceLine" id="cb4-6" data-line-number="6">[<span class="dv">1</span>] <span class="fl">8.240042</span></a>
<a class="sourceLine" id="cb4-7" data-line-number="7">mean_using_MLEs &lt;-<span class="st"> </span>lambda_MLE <span class="op">*</span><span class="st"> </span><span class="kw">gamma</span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span><span class="dv">1</span><span class="op">/</span>k_MLE)</a>
<a class="sourceLine" id="cb4-8" data-line-number="8">mean_using_MLEs</a>
<a class="sourceLine" id="cb4-9" data-line-number="9">[<span class="dv">1</span>] <span class="fl">7.298033</span></a>
<a class="sourceLine" id="cb4-10" data-line-number="10">median_using_MLEs &lt;-<span class="st"> </span>lambda_MLE <span class="op">*</span><span class="st"> </span>(<span class="kw">log</span>(<span class="dv">2</span>))<span class="op">^</span>(<span class="dv">1</span><span class="op">/</span>k_MLE)</a>
<a class="sourceLine" id="cb4-11" data-line-number="11">median_using_MLEs</a>
<a class="sourceLine" id="cb4-12" data-line-number="12">[<span class="dv">1</span>] <span class="fl">6.923497</span></a></code></pre></div>
<p>Wrapper function for simulating the same data set and fitting it, just showing the fitted parameters here (the random number seed is fixed in the simulation function, hence the result is the same as above):</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1"><span class="kw">h_nr_one_sim_fit</span>(<span class="dt">N=</span><span class="dv">10</span>)<span class="op">$</span>estimate</a>
<a class="sourceLine" id="cb5-2" data-line-number="2">[<span class="dv">1</span>] <span class="fl">2.105375</span> <span class="fl">8.240042</span></a></code></pre></div>
</div>
<div id="real-data-analyse-as-a-data-frame" class="section level2">
<h2>Real data, analyse as a data frame</h2>
<p>Once we have much larger values of <span class="math inline">\(N\)</span> it makes more sense to use a long data frame format for the data, particularly since we know the matrix is always upper triangular.</p>
<p>The actual data in British Columbia look like this, with a simple histogram of the delay times between symptom onset and reporting of a case:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1">delay_data</a>
<a class="sourceLine" id="cb6-2" data-line-number="2"><span class="co"># A tibble: 1,066 x 3</span></a>
<a class="sourceLine" id="cb6-3" data-line-number="3">   reported_date symptom_onset_date time_to_report</a>
<a class="sourceLine" id="cb6-4" data-line-number="4">   <span class="op">&lt;</span>date<span class="op">&gt;</span><span class="st">        </span><span class="er">&lt;</span>date<span class="op">&gt;</span><span class="st">             </span><span class="er">&lt;</span>drtn<span class="op">&gt;</span><span class="st">        </span></a>
<a class="sourceLine" id="cb6-5" data-line-number="5"><span class="st"> </span><span class="dv">1</span> <span class="dv">2020-01-27</span>    <span class="dv">2020-01-22</span>          <span class="dv">5</span> days       </a>
<a class="sourceLine" id="cb6-6" data-line-number="6"> <span class="dv">2</span> <span class="dv">2020-02-02</span>    <span class="dv">2020-01-27</span>          <span class="dv">6</span> days       </a>
<a class="sourceLine" id="cb6-7" data-line-number="7"> <span class="dv">3</span> <span class="dv">2020-02-05</span>    <span class="dv">2020-01-24</span>         <span class="dv">12</span> days       </a>
<a class="sourceLine" id="cb6-8" data-line-number="8"> <span class="dv">4</span> <span class="dv">2020-02-05</span>    <span class="dv">2020-01-15</span>         <span class="dv">21</span> days       </a>
<a class="sourceLine" id="cb6-9" data-line-number="9"> <span class="dv">5</span> <span class="dv">2020-02-11</span>    <span class="dv">2020-02-09</span>          <span class="dv">2</span> days       </a>
<a class="sourceLine" id="cb6-10" data-line-number="10"> <span class="dv">6</span> <span class="dv">2020-02-20</span>    <span class="dv">2020-02-14</span>          <span class="dv">6</span> days       </a>
<a class="sourceLine" id="cb6-11" data-line-number="11"> <span class="dv">7</span> <span class="dv">2020-02-22</span>    <span class="dv">2020-02-18</span>          <span class="dv">4</span> days       </a>
<a class="sourceLine" id="cb6-12" data-line-number="12"> <span class="dv">8</span> <span class="dv">2020-03-02</span>    <span class="dv">2020-02-25</span>          <span class="dv">6</span> days       </a>
<a class="sourceLine" id="cb6-13" data-line-number="13"> <span class="dv">9</span> <span class="dv">2020-03-02</span>    <span class="dv">2020-02-27</span>          <span class="dv">4</span> days       </a>
<a class="sourceLine" id="cb6-14" data-line-number="14"><span class="dv">10</span> <span class="dv">2020-03-03</span>    <span class="dv">2020-02-27</span>          <span class="dv">5</span> days       </a>
<a class="sourceLine" id="cb6-15" data-line-number="15"><span class="co"># ... with 1,056 more rows</span></a>
<a class="sourceLine" id="cb6-16" data-line-number="16">time_report_vec =<span class="st"> </span><span class="dv">0</span><span class="op">:</span>(<span class="kw">as.numeric</span>(<span class="kw">max</span>(delay_data<span class="op">$</span>time_to_report)) <span class="op">+</span><span class="st"> </span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb6-17" data-line-number="17"><span class="kw">hist</span>(<span class="kw">as.numeric</span>(delay_data<span class="op">$</span>time_to_report),</a>
<a class="sourceLine" id="cb6-18" data-line-number="18">     <span class="dt">breaks =</span> time_report_vec,</a>
<a class="sourceLine" id="cb6-19" data-line-number="19">     <span class="dt">right =</span> <span class="ot">FALSE</span>,</a>
<a class="sourceLine" id="cb6-20" data-line-number="20">     <span class="dt">xlab =</span> <span class="st">&quot;Time from symptom onset to reported case (days)&quot;</span>,</a>
<a class="sourceLine" id="cb6-21" data-line-number="21">     <span class="dt">main =</span> <span class="st">&quot;&quot;</span>,</a>
<a class="sourceLine" id="cb6-22" data-line-number="22">     <span class="dt">col =</span> <span class="st">&quot;lightgrey&quot;</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>To see the individual cases as points, with barplots that summarise the values for each day.:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1">plotdelay1 &lt;-<span class="st"> </span><span class="kw">plot_time_to_report</span>(delay_data, <span class="dt">x_axis =</span> <span class="st">&quot;onset&quot;</span>,</a>
<a class="sourceLine" id="cb7-2" data-line-number="2">                                  <span class="dt">xLim =</span> <span class="kw">c</span>(lubridate<span class="op">::</span><span class="kw">ymd</span>(<span class="st">&quot;2020-02-28&quot;</span>),</a>
<a class="sourceLine" id="cb7-3" data-line-number="3">                                           <span class="kw">max</span>(delay_data<span class="op">$</span>reported_date) <span class="op">+</span><span class="st"> </span><span class="dv">2</span>))</a>
<a class="sourceLine" id="cb7-4" data-line-number="4">plotdelay2 &lt;-<span class="st"> </span><span class="kw">plot_time_to_report</span>(delay_data,</a>
<a class="sourceLine" id="cb7-5" data-line-number="5">                                  <span class="dt">xLim =</span> <span class="kw">c</span>(lubridate<span class="op">::</span><span class="kw">ymd</span>(<span class="st">&quot;2020-02-28&quot;</span>),</a>
<a class="sourceLine" id="cb7-6" data-line-number="6">                                           <span class="kw">max</span>(delay_data<span class="op">$</span>reported_date) <span class="op">+</span><span class="st"> </span><span class="dv">2</span>))</a></code></pre></div>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1">gridExtra<span class="op">::</span><span class="kw">grid.arrange</span>(</a>
<a class="sourceLine" id="cb8-2" data-line-number="2">             plotdelay1,</a>
<a class="sourceLine" id="cb8-3" data-line-number="3">             plotdelay2,</a>
<a class="sourceLine" id="cb8-4" data-line-number="4">             <span class="dt">ncol=</span><span class="dv">1</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>By definition there can be no values above the dashed 1:1 line in the top panel, because the delays to reporting are too long (any cases will be reported in the future, with data only up to 2020-05-05.</p>
<p>The actual values we need for the likelihood calculations are just counts <span class="math inline">\(h_{nr}\)</span> of the number of cases that had symptom onset on day <span class="math inline">\(n\)</span> and were reported on day <span class="math inline">\(r\)</span>, where <span class="math inline">\(n\)</span> and <span class="math inline">\(r\)</span> take values from <span class="math inline">\(0\)</span> to <span class="math inline">\(N\)</span>. This function converts the above tibble into the required form:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" data-line-number="1">h_nr_tibble &lt;-<span class="st"> </span><span class="kw">make_h_nr_tibble</span>(delay_data)</a>
<a class="sourceLine" id="cb9-2" data-line-number="2">h_nr_tibble</a>
<a class="sourceLine" id="cb9-3" data-line-number="3"><span class="co"># A tibble: 605 x 3</span></a>
<a class="sourceLine" id="cb9-4" data-line-number="4">       n     r  h_nr</a>
<a class="sourceLine" id="cb9-5" data-line-number="5">   <span class="op">&lt;</span>dbl<span class="op">&gt;</span><span class="st"> </span><span class="er">&lt;</span>dbl<span class="op">&gt;</span><span class="st"> </span><span class="er">&lt;</span>int<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb9-6" data-line-number="6"><span class="st"> </span><span class="dv">1</span>     <span class="dv">0</span>    <span class="dv">21</span>     <span class="dv">1</span></a>
<a class="sourceLine" id="cb9-7" data-line-number="7"> <span class="dv">2</span>     <span class="dv">7</span>    <span class="dv">12</span>     <span class="dv">1</span></a>
<a class="sourceLine" id="cb9-8" data-line-number="8"> <span class="dv">3</span>     <span class="dv">9</span>    <span class="dv">21</span>     <span class="dv">1</span></a>
<a class="sourceLine" id="cb9-9" data-line-number="9"> <span class="dv">4</span>    <span class="dv">12</span>    <span class="dv">18</span>     <span class="dv">1</span></a>
<a class="sourceLine" id="cb9-10" data-line-number="10"> <span class="dv">5</span>    <span class="dv">25</span>    <span class="dv">27</span>     <span class="dv">1</span></a>
<a class="sourceLine" id="cb9-11" data-line-number="11"> <span class="dv">6</span>    <span class="dv">30</span>    <span class="dv">36</span>     <span class="dv">1</span></a>
<a class="sourceLine" id="cb9-12" data-line-number="12"> <span class="dv">7</span>    <span class="dv">31</span>    <span class="dv">53</span>     <span class="dv">1</span></a>
<a class="sourceLine" id="cb9-13" data-line-number="13"> <span class="dv">8</span>    <span class="dv">34</span>    <span class="dv">38</span>     <span class="dv">1</span></a>
<a class="sourceLine" id="cb9-14" data-line-number="14"> <span class="dv">9</span>    <span class="dv">36</span>    <span class="dv">58</span>     <span class="dv">1</span></a>
<a class="sourceLine" id="cb9-15" data-line-number="15"><span class="dv">10</span>    <span class="dv">37</span>    <span class="dv">64</span>     <span class="dv">1</span></a>
<a class="sourceLine" id="cb9-16" data-line-number="16"><span class="co"># ... with 595 more rows</span></a>
<a class="sourceLine" id="cb9-17" data-line-number="17"><span class="co"># Show how many of each h_nr values there are:</span></a>
<a class="sourceLine" id="cb9-18" data-line-number="18"><span class="kw">summary</span>(<span class="kw">as.factor</span>(h_nr_tibble<span class="op">$</span>h_nr))</a>
<a class="sourceLine" id="cb9-19" data-line-number="19">  <span class="dv">1</span>   <span class="dv">2</span>   <span class="dv">3</span>   <span class="dv">4</span>   <span class="dv">5</span>   <span class="dv">6</span>   <span class="dv">7</span>   <span class="dv">8</span> </a>
<a class="sourceLine" id="cb9-20" data-line-number="20"><span class="dv">341</span> <span class="dv">147</span>  <span class="dv">72</span>  <span class="dv">25</span>  <span class="dv">10</span>   <span class="dv">6</span>   <span class="dv">3</span>   <span class="dv">1</span> </a></code></pre></div>
<p>To calculate the maximum likelihood estimates for <span class="math inline">\(k\)</span> and <span class="math inline">\(\lambda\)</span>:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" data-line-number="1">MLE &lt;-<span class="st"> </span><span class="kw">nlm</span>(<span class="dt">f =</span> negLL_Weibull_counts_tibble,</a>
<a class="sourceLine" id="cb10-2" data-line-number="2">           <span class="dt">p =</span> <span class="kw">c</span>(<span class="dv">3</span>,<span class="dv">15</span>),</a>
<a class="sourceLine" id="cb10-3" data-line-number="3">           <span class="dt">h_nr_tibble =</span> h_nr_tibble)</a>
<a class="sourceLine" id="cb10-4" data-line-number="4"></a>
<a class="sourceLine" id="cb10-5" data-line-number="5">k_MLE &lt;-<span class="st"> </span>MLE<span class="op">$</span>estimate[<span class="dv">1</span>]</a>
<a class="sourceLine" id="cb10-6" data-line-number="6">lambda_MLE &lt;-<span class="st"> </span>MLE<span class="op">$</span>estimate[<span class="dv">2</span>]</a>
<a class="sourceLine" id="cb10-7" data-line-number="7">k_MLE      <span class="co"># shape</span></a>
<a class="sourceLine" id="cb10-8" data-line-number="8">[<span class="dv">1</span>] <span class="fl">1.655612</span></a>
<a class="sourceLine" id="cb10-9" data-line-number="9">lambda_MLE <span class="co"># scale</span></a>
<a class="sourceLine" id="cb10-10" data-line-number="10">[<span class="dv">1</span>] <span class="fl">9.901742</span></a>
<a class="sourceLine" id="cb10-11" data-line-number="11">mean_using_MLEs &lt;-<span class="st"> </span>lambda_MLE <span class="op">*</span><span class="st"> </span><span class="kw">gamma</span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span><span class="dv">1</span><span class="op">/</span>k_MLE)</a>
<a class="sourceLine" id="cb10-12" data-line-number="12">mean_using_MLEs</a>
<a class="sourceLine" id="cb10-13" data-line-number="13">[<span class="dv">1</span>] <span class="fl">8.851888</span></a>
<a class="sourceLine" id="cb10-14" data-line-number="14">median_using_MLEs &lt;-<span class="st"> </span>lambda_MLE <span class="op">*</span><span class="st"> </span>(<span class="kw">log</span>(<span class="dv">2</span>))<span class="op">^</span>(<span class="dv">1</span><span class="op">/</span>k_MLE)</a>
<a class="sourceLine" id="cb10-15" data-line-number="15">median_using_MLEs</a>
<a class="sourceLine" id="cb10-16" data-line-number="16">[<span class="dv">1</span>] <span class="fl">7.935406</span></a></code></pre></div>
<p>For the manuscript, we used the data between February 29 and April 2:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" data-line-number="1">h_nr_manuscript &lt;-<span class="st"> </span><span class="kw">make_h_nr_tibble</span>(delay_data,</a>
<a class="sourceLine" id="cb11-2" data-line-number="2">                                    <span class="dt">day_0 =</span> lubridate<span class="op">::</span><span class="kw">ymd</span>(<span class="st">&quot;2020-02-29&quot;</span>),</a>
<a class="sourceLine" id="cb11-3" data-line-number="3">                                    <span class="dt">day_N =</span> lubridate<span class="op">::</span><span class="kw">ymd</span>(<span class="st">&quot;2020-04-02&quot;</span>))</a>
<a class="sourceLine" id="cb11-4" data-line-number="4">MLE_man &lt;-<span class="st"> </span><span class="kw">nlm</span>(<span class="dt">f =</span> negLL_Weibull_counts_tibble,</a>
<a class="sourceLine" id="cb11-5" data-line-number="5">               <span class="dt">p =</span> <span class="kw">c</span>(<span class="dv">3</span>,<span class="dv">15</span>),</a>
<a class="sourceLine" id="cb11-6" data-line-number="6">               <span class="dt">h_nr_tibble =</span> h_nr_manuscript)</a>
<a class="sourceLine" id="cb11-7" data-line-number="7">k_MLE_man &lt;-<span class="st"> </span>MLE_man<span class="op">$</span>estimate[<span class="dv">1</span>]</a>
<a class="sourceLine" id="cb11-8" data-line-number="8">lambda_MLE_man &lt;-<span class="st"> </span>MLE_man<span class="op">$</span>estimate[<span class="dv">2</span>]</a>
<a class="sourceLine" id="cb11-9" data-line-number="9">k_MLE_man      <span class="co"># shape</span></a>
<a class="sourceLine" id="cb11-10" data-line-number="10">[<span class="dv">1</span>] <span class="fl">1.752682</span></a>
<a class="sourceLine" id="cb11-11" data-line-number="11">lambda_MLE_man <span class="co"># scale</span></a>
<a class="sourceLine" id="cb11-12" data-line-number="12">[<span class="dv">1</span>] <span class="fl">9.844945</span></a>
<a class="sourceLine" id="cb11-13" data-line-number="13">mean_using_MLEs_man &lt;-<span class="st"> </span>lambda_MLE_man <span class="op">*</span><span class="st"> </span><span class="kw">gamma</span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span><span class="dv">1</span><span class="op">/</span>k_MLE_man)</a>
<a class="sourceLine" id="cb11-14" data-line-number="14">mean_using_MLEs_man</a>
<a class="sourceLine" id="cb11-15" data-line-number="15">[<span class="dv">1</span>] <span class="fl">8.767309</span></a>
<a class="sourceLine" id="cb11-16" data-line-number="16">median_using_MLEs_man &lt;-<span class="st"> </span>lambda_MLE_man <span class="op">*</span><span class="st"> </span>(<span class="kw">log</span>(<span class="dv">2</span>))<span class="op">^</span>(<span class="dv">1</span><span class="op">/</span>k_MLE_man)</a>
<a class="sourceLine" id="cb11-17" data-line-number="17">median_using_MLEs_man</a>
<a class="sourceLine" id="cb11-18" data-line-number="18">[<span class="dv">1</span>] <span class="fl">7.987219</span></a></code></pre></div>
<p>There are 667 individual cases there. In the manuscript we reported only 535, the difference being due to TODO [presumably updated data since the code was run for the manuscript]; difference is small (<span class="math inline">\(k_{MLE} = 1.73\)</span> and <span class="math inline">\(\lambda_{MLE} = 9.85\)</span> in the manuscript).</p>
<p>The following code is for plotting results for British Columbia and New Zealand, but is commented out because the New Zealand data cannot be made public. TODO: functionalise the plotting, and use BC as example.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" data-line-number="1"><span class="kw">png</span>(<span class="dt">filename =</span> <span class="st">&quot;delay-hist-BC-NZ.png&quot;</span>,</a>
<a class="sourceLine" id="cb12-2" data-line-number="2">    <span class="dt">width =</span> <span class="fl">6.8</span><span class="op">*</span><span class="dv">240</span>,</a>
<a class="sourceLine" id="cb12-3" data-line-number="3">    <span class="dt">height =</span> <span class="fl">4.5</span><span class="op">*</span><span class="dv">240</span>,</a>
<a class="sourceLine" id="cb12-4" data-line-number="4">    <span class="dt">res =</span> <span class="dv">240</span>)</a>
<a class="sourceLine" id="cb12-5" data-line-number="5">max_delay &lt;-<span class="st"> </span><span class="kw">max</span>(<span class="kw">c</span>(h_nr_manuscript<span class="op">$</span>r <span class="op">-</span><span class="st"> </span>h_nr_manuscript<span class="op">$</span>n, h_NZ<span class="op">$</span>breaks) <span class="op">+</span><span class="st"> </span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb12-6" data-line-number="6">time_report_vec =<span class="st"> </span><span class="kw">seq</span>(<span class="dv">0</span>, max_delay, <span class="dt">by=</span><span class="fl">0.1</span>)</a>
<a class="sourceLine" id="cb12-7" data-line-number="7"></a>
<a class="sourceLine" id="cb12-8" data-line-number="8">h_NZ &lt;-<span class="st"> </span><span class="kw">readRDS</span>(<span class="kw">paste0</span>(here<span class="op">::</span><span class="kw">here</span>(), <span class="st">&quot;/data-raw/NZ_histogram.rds&quot;</span>))</a>
<a class="sourceLine" id="cb12-9" data-line-number="9"></a>
<a class="sourceLine" id="cb12-10" data-line-number="10">time_report_BC =<span class="st"> </span><span class="kw">dweibull</span>(time_report_vec,</a>
<a class="sourceLine" id="cb12-11" data-line-number="11">                          <span class="dt">shape =</span> k_MLE_man,</a>
<a class="sourceLine" id="cb12-12" data-line-number="12">                          <span class="dt">scale =</span> lambda_MLE_man) <span class="op">*</span><span class="st"> </span><span class="kw">sum</span>(h_nr_manuscript<span class="op">$</span>h_nr)</a>
<a class="sourceLine" id="cb12-13" data-line-number="13">time_report_NZ =<span class="st"> </span><span class="kw">dweibull</span>(time_report_vec,</a>
<a class="sourceLine" id="cb12-14" data-line-number="14">                          <span class="dt">shape =</span> <span class="fl">1.53289</span>,</a>
<a class="sourceLine" id="cb12-15" data-line-number="15">                          <span class="dt">scale =</span> <span class="fl">7.818021</span>) <span class="op">*</span><span class="st"> </span><span class="kw">sum</span>(h_NZ<span class="op">$</span>counts)</a>
<a class="sourceLine" id="cb12-16" data-line-number="16"><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</a>
<a class="sourceLine" id="cb12-17" data-line-number="17"><span class="kw">hist</span>(<span class="kw">rep</span>(h_nr_manuscript<span class="op">$</span>r <span class="op">-</span><span class="st"> </span>h_nr_manuscript<span class="op">$</span>n, h_nr_manuscript<span class="op">$</span>h_nr),</a>
<a class="sourceLine" id="cb12-18" data-line-number="18">     <span class="dt">breaks =</span> <span class="dv">0</span><span class="op">:</span>max_delay,</a>
<a class="sourceLine" id="cb12-19" data-line-number="19">     <span class="dt">right =</span> <span class="ot">FALSE</span>,</a>
<a class="sourceLine" id="cb12-20" data-line-number="20">     <span class="dt">xlab =</span> <span class="st">&quot;Days from symptom onset to reporting&quot;</span>,</a>
<a class="sourceLine" id="cb12-21" data-line-number="21">     <span class="dt">main =</span> <span class="st">&quot;British Columbia&quot;</span>,</a>
<a class="sourceLine" id="cb12-22" data-line-number="22">     <span class="dt">col =</span> <span class="st">&quot;lightgrey&quot;</span>)</a>
<a class="sourceLine" id="cb12-23" data-line-number="23"><span class="kw">lines</span>(time_report_vec,</a>
<a class="sourceLine" id="cb12-24" data-line-number="24">      time_report_BC,</a>
<a class="sourceLine" id="cb12-25" data-line-number="25">      <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>,</a>
<a class="sourceLine" id="cb12-26" data-line-number="26">      <span class="dt">lwd =</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb12-27" data-line-number="27"><span class="kw">plot</span>(h_NZ,</a>
<a class="sourceLine" id="cb12-28" data-line-number="28">     <span class="dt">xlab =</span> <span class="st">&quot;Days from symptom onset to reporting&quot;</span>,</a>
<a class="sourceLine" id="cb12-29" data-line-number="29">     <span class="dt">main =</span> <span class="st">&quot;New Zealand&quot;</span>,</a>
<a class="sourceLine" id="cb12-30" data-line-number="30">     <span class="dt">col =</span> <span class="st">&quot;lightgrey&quot;</span>)</a>
<a class="sourceLine" id="cb12-31" data-line-number="31"><span class="kw">lines</span>(time_report_vec,</a>
<a class="sourceLine" id="cb12-32" data-line-number="32">      time_report_NZ,</a>
<a class="sourceLine" id="cb12-33" data-line-number="33">      <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>,</a>
<a class="sourceLine" id="cb12-34" data-line-number="34">      <span class="dt">lwd =</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb12-35" data-line-number="35"><span class="kw">dev.off</span>()</a></code></pre></div>
<div id="confidence-intervals" class="section level3">
<h3>Confidence intervals</h3>
<p>TODO: Have added sizeSpectra to DESCRIPTION, now test with this code from SIR-explore that I’ve only copied here:</p>
<p>Do univariate ones (Bolker book implies they’re often close to bivariate), set one parameter at MLE and get interval for the other (was not running every time in .Rmd since takes a while, so running once then putting results in):</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" data-line-number="1">k_confint &lt;-<span class="st"> </span><span class="kw">profLike</span>(negLL.Weibull.counts.df,</a>
<a class="sourceLine" id="cb13-2" data-line-number="2">                      <span class="dt">MLE =</span> k_MLE,</a>
<a class="sourceLine" id="cb13-3" data-line-number="3">                      <span class="dt">minNegLL =</span> MLE.res<span class="op">$</span>minimum,</a>
<a class="sourceLine" id="cb13-4" data-line-number="4">                      <span class="dt">vecInc =</span> <span class="fl">0.001</span>,</a>
<a class="sourceLine" id="cb13-5" data-line-number="5">                      <span class="dt">h_nr_df =</span> h_nr_df,</a>
<a class="sourceLine" id="cb13-6" data-line-number="6">                      <span class="dt">lambda_MLE =</span> lambda_MLE)</a>
<a class="sourceLine" id="cb13-7" data-line-number="7">k_confint  <span class="co">#  1.603928 1.857928   = 1.60-1.86</span></a>
<a class="sourceLine" id="cb13-8" data-line-number="8"></a>
<a class="sourceLine" id="cb13-9" data-line-number="9">lambda_confint &lt;-<span class="st"> </span><span class="kw">profLike</span>(negLL.Weibull.counts.df,</a>
<a class="sourceLine" id="cb13-10" data-line-number="10">                      <span class="dt">MLE =</span> lambda_MLE,</a>
<a class="sourceLine" id="cb13-11" data-line-number="11">                      <span class="dt">minNegLL =</span> MLE.res<span class="op">$</span>minimum,</a>
<a class="sourceLine" id="cb13-12" data-line-number="12">                      <span class="dt">vecInc =</span> <span class="fl">0.001</span>,</a>
<a class="sourceLine" id="cb13-13" data-line-number="13">                      <span class="dt">vecDiff =</span> <span class="fl">0.65</span>,</a>
<a class="sourceLine" id="cb13-14" data-line-number="14">                      <span class="dt">h_nr_df =</span> h_nr_df,</a>
<a class="sourceLine" id="cb13-15" data-line-number="15">                      <span class="dt">k_MLE =</span> k_MLE)</a>
<a class="sourceLine" id="cb13-16" data-line-number="16">lambda_confint  <span class="co">#  9.304579 10.462579   = 9.30-10.46</span></a>
<a class="sourceLine" id="cb13-17" data-line-number="17"><span class="co"># THEN check nlm works okay still</span></a></code></pre></div>
</div>
</div>
</div>
<div id="new-zealand-data" class="section level1">
<h1>New Zealand data</h1>
<p>[This summarises from above what is needed]</p>
<p>We would like to fit a Weibull distribution to data on the delays between a person having the onset of symptoms and them being reported as a confirmed cases of COVID-19 in New Zealand. The data we have in British Columbia is a tibble with these (self-explanatory) headings (final column is just difference between the first two):</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" data-line-number="1">delay_data</a>
<a class="sourceLine" id="cb14-2" data-line-number="2"><span class="co"># A tibble: 1,066 x 3</span></a>
<a class="sourceLine" id="cb14-3" data-line-number="3">   reported_date symptom_onset_date time_to_report</a>
<a class="sourceLine" id="cb14-4" data-line-number="4">   <span class="op">&lt;</span>date<span class="op">&gt;</span><span class="st">        </span><span class="er">&lt;</span>date<span class="op">&gt;</span><span class="st">             </span><span class="er">&lt;</span>drtn<span class="op">&gt;</span><span class="st">        </span></a>
<a class="sourceLine" id="cb14-5" data-line-number="5"><span class="st"> </span><span class="dv">1</span> <span class="dv">2020-01-27</span>    <span class="dv">2020-01-22</span>          <span class="dv">5</span> days       </a>
<a class="sourceLine" id="cb14-6" data-line-number="6"> <span class="dv">2</span> <span class="dv">2020-02-02</span>    <span class="dv">2020-01-27</span>          <span class="dv">6</span> days       </a>
<a class="sourceLine" id="cb14-7" data-line-number="7"> <span class="dv">3</span> <span class="dv">2020-02-05</span>    <span class="dv">2020-01-24</span>         <span class="dv">12</span> days       </a>
<a class="sourceLine" id="cb14-8" data-line-number="8"> <span class="dv">4</span> <span class="dv">2020-02-05</span>    <span class="dv">2020-01-15</span>         <span class="dv">21</span> days       </a>
<a class="sourceLine" id="cb14-9" data-line-number="9"> <span class="dv">5</span> <span class="dv">2020-02-11</span>    <span class="dv">2020-02-09</span>          <span class="dv">2</span> days       </a>
<a class="sourceLine" id="cb14-10" data-line-number="10"> <span class="dv">6</span> <span class="dv">2020-02-20</span>    <span class="dv">2020-02-14</span>          <span class="dv">6</span> days       </a>
<a class="sourceLine" id="cb14-11" data-line-number="11"> <span class="dv">7</span> <span class="dv">2020-02-22</span>    <span class="dv">2020-02-18</span>          <span class="dv">4</span> days       </a>
<a class="sourceLine" id="cb14-12" data-line-number="12"> <span class="dv">8</span> <span class="dv">2020-03-02</span>    <span class="dv">2020-02-25</span>          <span class="dv">6</span> days       </a>
<a class="sourceLine" id="cb14-13" data-line-number="13"> <span class="dv">9</span> <span class="dv">2020-03-02</span>    <span class="dv">2020-02-27</span>          <span class="dv">4</span> days       </a>
<a class="sourceLine" id="cb14-14" data-line-number="14"><span class="dv">10</span> <span class="dv">2020-03-03</span>    <span class="dv">2020-02-27</span>          <span class="dv">5</span> days       </a>
<a class="sourceLine" id="cb14-15" data-line-number="15"><span class="co"># ... with 1,056 more rows</span></a></code></pre></div>
<p>This gets converted into the desired form for the likelihood function:</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" data-line-number="1">h_nr_tibble &lt;-<span class="st"> </span><span class="kw">make_h_nr_tibble</span>(delay_data)</a>
<a class="sourceLine" id="cb15-2" data-line-number="2">h_nr_tibble</a>
<a class="sourceLine" id="cb15-3" data-line-number="3"><span class="co"># A tibble: 605 x 3</span></a>
<a class="sourceLine" id="cb15-4" data-line-number="4">       n     r  h_nr</a>
<a class="sourceLine" id="cb15-5" data-line-number="5">   <span class="op">&lt;</span>dbl<span class="op">&gt;</span><span class="st"> </span><span class="er">&lt;</span>dbl<span class="op">&gt;</span><span class="st"> </span><span class="er">&lt;</span>int<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb15-6" data-line-number="6"><span class="st"> </span><span class="dv">1</span>     <span class="dv">0</span>    <span class="dv">21</span>     <span class="dv">1</span></a>
<a class="sourceLine" id="cb15-7" data-line-number="7"> <span class="dv">2</span>     <span class="dv">7</span>    <span class="dv">12</span>     <span class="dv">1</span></a>
<a class="sourceLine" id="cb15-8" data-line-number="8"> <span class="dv">3</span>     <span class="dv">9</span>    <span class="dv">21</span>     <span class="dv">1</span></a>
<a class="sourceLine" id="cb15-9" data-line-number="9"> <span class="dv">4</span>    <span class="dv">12</span>    <span class="dv">18</span>     <span class="dv">1</span></a>
<a class="sourceLine" id="cb15-10" data-line-number="10"> <span class="dv">5</span>    <span class="dv">25</span>    <span class="dv">27</span>     <span class="dv">1</span></a>
<a class="sourceLine" id="cb15-11" data-line-number="11"> <span class="dv">6</span>    <span class="dv">30</span>    <span class="dv">36</span>     <span class="dv">1</span></a>
<a class="sourceLine" id="cb15-12" data-line-number="12"> <span class="dv">7</span>    <span class="dv">31</span>    <span class="dv">53</span>     <span class="dv">1</span></a>
<a class="sourceLine" id="cb15-13" data-line-number="13"> <span class="dv">8</span>    <span class="dv">34</span>    <span class="dv">38</span>     <span class="dv">1</span></a>
<a class="sourceLine" id="cb15-14" data-line-number="14"> <span class="dv">9</span>    <span class="dv">36</span>    <span class="dv">58</span>     <span class="dv">1</span></a>
<a class="sourceLine" id="cb15-15" data-line-number="15"><span class="dv">10</span>    <span class="dv">37</span>    <span class="dv">64</span>     <span class="dv">1</span></a>
<a class="sourceLine" id="cb15-16" data-line-number="16"><span class="co"># ... with 595 more rows</span></a></code></pre></div>
<p>and the maximum likelihood calculation is then run using:</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" data-line-number="1">MLE &lt;-<span class="st"> </span><span class="kw">nlm</span>(<span class="dt">f =</span> negLL_Weibull_counts_tibble,</a>
<a class="sourceLine" id="cb16-2" data-line-number="2">           <span class="dt">p =</span> <span class="kw">c</span>(<span class="dv">3</span>,<span class="dv">15</span>),</a>
<a class="sourceLine" id="cb16-3" data-line-number="3">           <span class="dt">h_nr_tibble =</span> h_nr_tibble)</a>
<a class="sourceLine" id="cb16-4" data-line-number="4">MLE</a>
<a class="sourceLine" id="cb16-5" data-line-number="5"><span class="op">$</span>minimum</a>
<a class="sourceLine" id="cb16-6" data-line-number="6">[<span class="dv">1</span>] <span class="fl">3214.01</span></a>
<a class="sourceLine" id="cb16-7" data-line-number="7"></a>
<a class="sourceLine" id="cb16-8" data-line-number="8"><span class="op">$</span>estimate</a>
<a class="sourceLine" id="cb16-9" data-line-number="9">[<span class="dv">1</span>] <span class="fl">1.655612</span> <span class="fl">9.901742</span></a>
<a class="sourceLine" id="cb16-10" data-line-number="10"></a>
<a class="sourceLine" id="cb16-11" data-line-number="11"><span class="op">$</span>gradient</a>
<a class="sourceLine" id="cb16-12" data-line-number="12">[<span class="dv">1</span>] <span class="fl">-0.0008264829</span>  <span class="fl">0.0001091202</span></a>
<a class="sourceLine" id="cb16-13" data-line-number="13"></a>
<a class="sourceLine" id="cb16-14" data-line-number="14"><span class="op">$</span>code</a>
<a class="sourceLine" id="cb16-15" data-line-number="15">[<span class="dv">1</span>] <span class="dv">1</span></a>
<a class="sourceLine" id="cb16-16" data-line-number="16"></a>
<a class="sourceLine" id="cb16-17" data-line-number="17"><span class="op">$</span>iterations</a>
<a class="sourceLine" id="cb16-18" data-line-number="18">[<span class="dv">1</span>] <span class="dv">12</span></a></code></pre></div>
<p>Please let me know what form the NZ data are in, and I can write a wrapper function to enable you to run the likelihood calculation.</p>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
